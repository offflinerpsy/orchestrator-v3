# ğŸ›¡ï¸ V1 Guardian â€” ĞœĞ°ÑÑ‚ĞµÑ€-Ğ¿Ğ»Ğ°Ğ½ ÑÑ‚Ğ°Ğ±Ğ¸Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°

**Ğ”Ğ°Ñ‚Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ:** 2025-10-19  
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** Ğ’ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ  
**Ğ’ĞµÑ‚ĞºĞ°:** `feat/v1-guardian`  
**Ğ¦ĞµĞ»ÑŒ:** ĞĞ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°, Ğ°Ğ²Ñ‚Ğ¾Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¸ Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ¸

---

## ğŸ“– ĞĞ³Ğ»Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

1. [ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ](#ĞºĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ)
2. [ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°](#Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°)
3. [Roadmap (10 ÑĞ¿Ñ€Ğ¸Ğ½Ñ‚Ğ¾Ğ²)](#roadmap)
4. [Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº](#Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹-ÑÑ‚ĞµĞº)
5. [Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¾Ğ¹](#Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ)
6. [ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ÑƒÑĞ¿ĞµÑ…Ğ°](#Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸-ÑƒÑĞ¿ĞµÑ…Ğ°)

---

## ğŸ¯ ĞšĞ¾Ğ½Ñ†ĞµĞ¿Ñ†Ğ¸Ñ

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°
**Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ ÑĞ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ñ (ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚ 9b2f1c8):**
- âœ… Sprint 1 Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½ (8/8 Ğ·Ğ°Ğ´Ğ°Ñ‡): service control, error boundaries, FLUX dry-run
- âŒ Dev server ĞºÑ€Ğ°ÑˆĞ¸Ñ‚ Ğ½Ğ° ÑÑ‚Ğ°Ñ€Ñ‚Ğµ (Exit code 1)
- âŒ ĞĞµÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° ÑĞ»ÑƒĞ¶Ğ± Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ Windows
- âŒ ĞĞµÑ‚ Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° (Ğ»Ğ¾Ğ³Ğ¸/Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸/Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸)
- âŒ ĞĞµÑ‚ ÑĞ¼Ğ¾ÑƒĞº-Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ¸ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸
- âŒ ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ±Ğ°Ğ³-Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ğ¾Ğ²

### Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ: V1 Guardian
**ĞĞ²Ñ‚Ğ¾Ğ½Ğ¾Ğ¼Ğ½Ğ°Ñ ÑĞ»ÑƒĞ¶Ğ±Ğ° Windows (Node.js/TypeScript), ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ:**

1. **ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ‚** ÑÑ‚ĞµĞº 24/7 (ComfyUI, AdminPanel, Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğµ API)
2. **Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚** ÑƒĞ¿Ğ°Ğ²ÑˆĞ¸Ğµ ÑĞ»ÑƒĞ¶Ğ±Ñ‹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
3. **Ğ¡Ğ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚** Ğ»Ğ¾Ğ³Ğ¸/Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸/Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ² ĞµĞ´Ğ¸Ğ½ÑƒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ½Ğ°Ğ±Ğ»ÑĞ´Ğ°ĞµĞ¼Ğ¾ÑÑ‚Ğ¸
4. **Ğ“Ğ¾Ğ½ÑĞµÑ‚** ÑĞ¼Ğ¾ÑƒĞº-Ñ‚ĞµÑÑ‚Ñ‹ (Playwright) Ğ¿Ğ¾ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ
5. **Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚** ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ±Ğ°Ğ³-Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹ Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ¼
6. **ĞŸÑ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚** Ğ±ĞµĞ»Ñ‹Ğ¹ ÑĞºÑ€Ğ°Ğ½ Ñ‡ĞµÑ€ĞµĞ· Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑĞ½Ğ¸Ğ¼ĞºĞ¸

---

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Windows OS (Auto-start)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   ComfyUI   â”‚  â”‚  AdminPanel  â”‚  â”‚  V1 Guardian â”‚       â”‚
â”‚  â”‚   Service   â”‚  â”‚   Service    â”‚  â”‚   Service    â”‚       â”‚
â”‚  â”‚  (NSSM)     â”‚  â”‚   (NSSM)     â”‚  â”‚   (NSSM)     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                â”‚                  â”‚                â”‚
â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                â”‚
â”‚         â””â”€â”€â”€â–ºâ”‚  Next.js App Router   â”‚â—„â”€â”€â”€â”€â”€â”˜                â”‚
â”‚              â”‚   /api/health         â”‚                       â”‚
â”‚              â”‚   /api/metrics        â”‚                       â”‚
â”‚              â”‚   /api/guardian/*     â”‚                       â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                          â”‚                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â”‚                â”‚                â”‚                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚  Sentry  â”‚   â”‚ Prometheus â”‚   â”‚   Loki   â”‚            â”‚
â”‚    â”‚  (Cloud) â”‚   â”‚  + Grafana â”‚   â”‚+ Promtailâ”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ¡Ğ»ÑƒĞ¶Ğ±Ğ° V1 Guardian

**Ğ Ğ°ÑĞ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ:** `C:\Work\Orchestrator\services\guardian\`

**Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°:**
```
services/
â””â”€â”€ guardian/
    â”œâ”€â”€ index.ts              # Main entry point
    â”œâ”€â”€ config.ts             # Configuration (intervals, thresholds)
    â”œâ”€â”€ monitors/
    â”‚   â”œâ”€â”€ health-check.ts   # Ping /api/health
    â”‚   â”œâ”€â”€ service-watch.ts  # Monitor Windows services
    â”‚   â”œâ”€â”€ disk-watch.ts     # Check F:\ space
    â”‚   â””â”€â”€ api-watch.ts      # Test ComfyUI/FLUX/v0
    â”œâ”€â”€ recovery/
    â”‚   â”œâ”€â”€ restart-service.ts # Auto-restart failed services
    â”‚   â””â”€â”€ escalation.ts      # Create bug reports
    â”œâ”€â”€ testing/
    â”‚   â”œâ”€â”€ smoke-runner.ts    # Run Playwright tests
    â”‚   â””â”€â”€ visual-diff.ts     # Compare screenshots
    â”œâ”€â”€ reporting/
    â”‚   â”œâ”€â”€ bug-report.ts      # Generate MD reports
    â”‚   â””â”€â”€ metrics.ts         # Custom Prometheus metrics
    â””â”€â”€ utils/
        â”œâ”€â”€ logger.ts          # Structured JSON logging
        â””â”€â”€ alerts.ts          # Send notifications
```

---

## ğŸ—“ï¸ Roadmap (10 ÑĞ¿Ñ€Ğ¸Ğ½Ñ‚Ğ¾Ğ² Ã— 2 Ğ´Ğ½Ñ)

### Sprint 0: ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° (Ğ¢Ğ•ĞšĞ£Ğ©Ğ˜Ğ™)
**Ğ¦ĞµĞ»ÑŒ:** Ğ—Ğ°Ñ„Ğ¸ĞºÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ»Ğ°Ğ½, Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
- [x] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `V1-GUARDIAN-MASTER-PLAN.md`
- [ ] ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `PROJECT-RULES.md` (Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°)
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `services/guardian/` ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ
- [ ] Ğ—Ğ°Ğ¿ÑƒÑˆĞ¸Ñ‚ÑŒ plan Ğ² Git

**Deliverables:**
- Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ°
- Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ°Ğ¿Ğ¾Ğº ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ°
- Branch `feat/v1-guardian` Ğ³Ğ¾Ñ‚Ğ¾Ğ²

---

### Sprint 1: Ğ¤ÑƒĞ½Ğ´Ğ°Ğ¼ĞµĞ½Ñ‚ Guardian Service
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P0  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2 Ğ´Ğ½Ñ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **Ğ¡Ğ»ÑƒĞ¶Ğ±Ğ° Guardian ĞºĞ°Ğº NSSM**
   - `scripts/install-guardian-service.ps1`
   - `services/guardian/index.ts` â€” Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°
   - Ğ¡Ñ‚Ğ°Ñ€Ñ‚/ÑÑ‚Ğ¾Ğ¿ Ñ‡ĞµÑ€ĞµĞ· `/api/guardian/control`

2. **Health Check Endpoint**
   - Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€ `/api/status` â†’ `/api/health`
   - Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ: `services`, `comfy`, `models`, `diskF`, `memory`
   - JSON-Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ Ñ Kubernetes liveness/readiness

3. **Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³**
   - `monitors/health-check.ts` â€” ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 30 ÑĞµĞºÑƒĞ½Ğ´ ping `/api/health`
   - `monitors/service-watch.ts` â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° PID ÑĞ»ÑƒĞ¶Ğ±
   - Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² `F:\Logs\guardian\guardian.log` (JSON)

**Proof of Concept:**
```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Guardian
.\scripts\install-guardian-service.ps1

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹
nssm status V1Guardian  # â†’ RUNNING

# Health check
curl http://localhost:3000/api/health
# {
#   "status": "healthy",
#   "timestamp": "2025-10-19T20:00:00.000Z",
#   "services": {
#     "comfy": {"status": "running", "pid": 12345},
#     "panel": {"status": "running", "pid": 67890}
#   },
#   "comfy": {"vram": 11GB, "queue": 0},
#   "disk": {"F": {"free": 250GB, "total": 500GB}}
# }
```

**Deliverables:**
- Guardian Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ ĞºĞ°Ğº ÑĞ»ÑƒĞ¶Ğ±Ğ° Windows
- `/api/health` Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ‚ÑƒÑ
- Ğ›Ğ¾Ğ³Ğ¸ Ğ¿Ğ¸ÑˆÑƒÑ‚ÑÑ Ğ² JSON

---

### Sprint 2: Auto-Recovery
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P0  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2 Ğ´Ğ½Ñ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº ÑĞ»ÑƒĞ¶Ğ±**
   - `recovery/restart-service.ts`
   - ĞŸÑ€Ğ¸ Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¸ ComfyUI â†’ `nssm restart OrchestratorComfyUI`
   - ĞŸÑ€Ğ¸ Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¸ Panel â†’ `nssm restart OrchestratorPanel`
   - Cooldown 30 ÑĞµĞºÑƒĞ½Ğ´ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ°Ğ¼Ğ¸

2. **Escalation Logic**
   - 3 Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ½Ñ‹Ñ… Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¿Ğ¾Ğ´Ñ€ÑĞ´ â†’ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ±Ğ°Ğ³-Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚
   - `recovery/escalation.ts` â†’ Ğ²Ñ‹Ğ·Ğ¾Ğ² `reporting/bug-report.ts`

3. **Ğ‘Ğ°Ğ³-Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹**
   - `reporting/bug-report.ts`
   - Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: `F:\Logs\reports\BUG-YYYYMMDD-HHMM.md`
   - Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ:
     - Timestamp
     - Ğ£Ğ¿Ğ°Ğ²ÑˆĞ¸Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ
     - ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 50 ÑÑ‚Ñ€Ğ¾Ğº Ğ»Ğ¾Ğ³Ğ¾Ğ²
     - Health check snapshot
     - ComfyUI /system_stats (ĞµÑĞ»Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½)
     - Sentry Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ (ĞµÑĞ»Ğ¸ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½)

**Proof:**
```bash
# Ğ¢ĞµÑÑ‚: ÑƒĞ±Ğ¸Ñ‚ÑŒ ComfyUI Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ
taskkill /PID <comfy-pid> /F

# Guardian Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½:
# 1. ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸Ñ‚ÑŒ Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· 30 ÑĞµĞº
# 2. ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞ»ÑƒĞ¶Ğ±Ñƒ
# 3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚
# 4. Ğ—Ğ°Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ»Ğ¾Ğ³Ğ¾Ğ²
type F:\Logs\guardian\guardian.log | findstr "recovery"
# {"level":"warn","service":"ComfyUI","action":"restart","attempt":1}
# {"level":"info","service":"ComfyUI","status":"recovered"}
```

**Deliverables:**
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ recovery Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- Ğ‘Ğ°Ğ³-Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒÑÑ‚ÑÑ
- Escalation Ğ¿Ñ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ±ĞµÑĞºĞ¾Ğ½ĞµÑ‡Ğ½Ñ‹Ğµ Ñ€ĞµÑÑ‚Ğ°Ñ€Ñ‚Ñ‹

---

### Sprint 3: Prometheus Metrics
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P1  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2 Ğ´Ğ½Ñ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **Metrics Endpoint**
   - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `prom-client` Ğ² admin panel
   - `/api/metrics` â€” Prometheus text format
   - ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸:
     - `orchestrator_http_requests_total{method,path,status}`
     - `orchestrator_http_request_duration_seconds{method,path}`
     - `orchestrator_comfy_queue_depth`
     - `orchestrator_disk_free_bytes{disk="F"}`
     - `orchestrator_service_up{service="comfy|panel|guardian"}`

2. **Windows Exporter**
   - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `windows_exporter` ĞºĞ°Ğº ÑĞ»ÑƒĞ¶Ğ±Ğ°
   - ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³: CPU, RAM, Disk I/O, Network
   - ĞŸĞ¾Ñ€Ñ‚: 9182

3. **Guardian Custom Metrics**
   - `reporting/metrics.ts`
   - `guardian_restarts_total{service}`
   - `guardian_health_check_duration_seconds`
   - `guardian_last_check_timestamp`

4. **Prometheus Server**
   - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Prometheus Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ (Ğ¸Ğ»Ğ¸ Docker)
   - `prometheus.yml`:
     ```yaml
     scrape_configs:
       - job_name: 'orchestrator'
         static_configs:
           - targets: ['localhost:3000']  # /api/metrics
       
       - job_name: 'windows'
         static_configs:
           - targets: ['localhost:9182']  # windows_exporter
       
       - job_name: 'guardian'
         static_configs:
           - targets: ['localhost:9091']  # Guardian pushgateway
     ```

**Proof:**
```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº AdminPanel
curl http://localhost:3000/api/metrics
# # HELP orchestrator_http_requests_total Total HTTP requests
# # TYPE orchestrator_http_requests_total counter
# orchestrator_http_requests_total{method="GET",path="/api/health",status="200"} 1234

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Windows Exporter
curl http://localhost:9182/metrics | findstr "windows_cpu"

# Prometheus UI
start http://localhost:9090/targets
# All targets Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ UP
```

**Deliverables:**
- `/api/metrics` Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- Prometheus ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
- Windows metrics Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹

---

### Sprint 4: Grafana Dashboards
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P1  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2 Ğ´Ğ½Ñ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **Grafana Setup**
   - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Grafana (MSI installer Ğ¸Ğ»Ğ¸ Docker)
   - Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Prometheus ĞºĞ°Ğº data source
   - ĞŸĞ¾Ñ€Ñ‚: 3003 (Ğ½Ğµ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ÑƒĞµÑ‚ Ñ Next.js 3000)

2. **Dashboard: V1 System Overview**
   - ĞŸĞ°Ğ½ĞµĞ»Ğ¸:
     - Service Status (comfy/panel/guardian) â€” Single Stat
     - HTTP Request Rate â€” Graph
     - Request Duration P50/P95/P99 â€” Graph
     - ComfyUI Queue Depth â€” Graph
     - Disk Free Space (F:) â€” Gauge
     - CPU/RAM Usage â€” Graph (Ğ¸Ğ· windows_exporter)
   - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ ĞºĞ°Ğº `grafana/dashboards/v1-system-overview.json`

3. **Dashboard: Guardian Operations**
   - ĞŸĞ°Ğ½ĞµĞ»Ğ¸:
     - Restart Events (timeline)
     - Health Check Success Rate
     - Recovery Duration
     - Bug Reports Generated (counter)

4. **Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² UI**
   - Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° `/diagnostics` Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ:
     - **"ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Grafana"** â†’ `http://localhost:3003/d/v1-system`

**Proof:**
```bash
# Grafana Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ°
start http://localhost:3003

# Dashboard Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ live-Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
# - Service status: Ğ·ĞµĞ»Ñ‘Ğ½Ñ‹Ğµ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹
# - Request rate: Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº
# - Queue depth: 0 (ĞµÑĞ»Ğ¸ Ğ½ĞµÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡)
```

**Deliverables:**
- Grafana ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ°
- 2 Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ñ‹
- ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ğ² UI Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚

---

### Sprint 5: Sentry Integration
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P1  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2 Ğ´Ğ½Ñ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **Sentry Setup**
   - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ½Ğ° sentry.io (Ğ¸Ğ»Ğ¸ self-hosted)
   - ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ DSN
   - Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² `.env.local`:
     ```bash
     SENTRY_DSN=https://...@o...ingest.sentry.io/...
     SENTRY_ORG=orchestrator
     SENTRY_PROJECT=v1-admin
     ```

2. **Next.js Integration**
   - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `@sentry/nextjs`
   - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `sentry.client.config.ts` Ğ¸ `sentry.server.config.ts`
   - Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ `sentry.edge.config.ts` (Ğ´Ğ»Ñ middleware)
   - Ğ’ `next.config.js`:
     ```js
     const { withSentryConfig } = require('@sentry/nextjs')
     module.exports = withSentryConfig(config, {
       silent: true,
       org: process.env.SENTRY_ORG,
       project: process.env.SENTRY_PROJECT
     })
     ```

3. **Guardian Integration**
   - Ğ’ `services/guardian/index.ts` Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Sentry client
   - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ¿Ñ€Ğ¸:
     - ĞĞµÑƒĞ´Ğ°Ñ‡Ğ½Ğ¾Ğ¼ recovery
     - Health check timeout
     - Service crash

4. **Bug Report Enhancement**
   - Ğ’ `reporting/bug-report.ts` Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ:
     - Ğ¡ÑÑ‹Ğ»ĞºĞ° Ğ½Ğ° Sentry issue (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
     - Last 5 events Ğ¸Ğ· Sentry API

5. **UI Integration**
   - Ğ’ `/diagnostics` Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞµĞºÑ†Ğ¸Ñ "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸":
     - Fetch Ğ¸Ğ· Sentry API (Ğ¸Ğ»Ğ¸ Ğ²ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ²Ğ¸Ğ´Ğ¶ĞµÑ‚)
     - ĞšĞ½Ğ¾Ğ¿ĞºĞ° "ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Sentry Dashboard"

**Proof:**
```bash
# Ğ¢ĞµÑÑ‚: Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ Ğ² dev mode
# Ğ’ Ğ»ÑĞ±Ğ¾Ğ¼ API route:
throw new Error('Test Sentry integration')

# Sentry Dashboard Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ:
# - Error message
# - Stack trace
# - Request context (URL, headers)
# - User info (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
```

**Deliverables:**
- Sentry Ğ»Ğ¾Ğ²Ğ¸Ñ‚ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ñ„Ñ€Ğ¾Ğ½Ñ‚Ğ° Ğ¸ Ğ±ÑĞºĞ°
- Guardian Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
- Bug reports ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ Sentry ÑÑÑ‹Ğ»ĞºĞ¸

---

### Sprint 6: Grafana Loki + Promtail
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P2  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2 Ğ´Ğ½Ñ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **Loki Setup**
   - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Grafana Loki (Windows binary Ğ¸Ğ»Ğ¸ Docker)
   - ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ `loki-local-config.yaml`:
     ```yaml
     auth_enabled: false
     server:
       http_listen_port: 3100
     ingester:
       lifecycler:
         ring:
           kvstore:
             store: inmemory
     schema_config:
       configs:
         - from: 2020-01-01
           store: boltdb-shipper
           object_store: filesystem
           schema: v11
     storage_config:
       boltdb_shipper:
         active_index_directory: F:/Loki/index
         cache_location: F:/Loki/cache
       filesystem:
         directory: F:/Loki/chunks
     ```

2. **Promtail Setup (Windows)**
   - Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Promtail Windows binary
   - ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ `promtail-config.yaml`:
     ```yaml
     server:
       http_listen_port: 9080
     
     clients:
       - url: http://localhost:3100/loki/api/v1/push
     
     scrape_configs:
       - job_name: guardian
         static_configs:
           - targets:
               - localhost
             labels:
               job: guardian
               __path__: F:/Logs/guardian/*.log
       
       - job_name: comfy
         static_configs:
           - targets:
               - localhost
             labels:
               job: comfy
               __path__: F:/ComfyUI/logs/*.log
       
       - job_name: admin
         static_configs:
           - targets:
               - localhost
             labels:
               job: admin
               __path__: C:/Work/Orchestrator/apps/admin/logs/*.log
     ```

3. **Structured Logging**
   - Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ Ğ²ÑĞµ Ğ»Ğ¾Ğ³Ğ¸ Ğ² JSON:
     - Guardian: ÑƒĞ¶Ğµ JSON (pino)
     - AdminPanel: ÑƒĞ¶Ğµ JSON (pino)
     - ComfyUI: Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ wrapper (Ğ¸Ğ»Ğ¸ Ğ¿Ğ°Ñ€ÑĞ¸Ñ‚ÑŒ plain text)

4. **Grafana Data Source**
   - Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Loki Ğ² Grafana
   - URL: `http://localhost:3100`

5. **Dashboard: Logs Explorer**
   - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´ Ñ Loki queries:
     - `{job="guardian"} |= "error"`
     - `{job="comfy"} |= "CUDA"`
     - `{job="admin"} |= "api"`
   - Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹: level, service, timestamp

6. **UI Integration**
   - Ğ’ `/diagnostics` Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ:
     - "ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ (Grafana Loki)"
     - Ğ˜Ğ½Ğ»Ğ°Ğ¹Ğ½-Ğ²Ğ¸Ğ´Ğ¶ĞµÑ‚: Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 10 ÑÑ‚Ñ€Ğ¾Ğº Ğ»Ğ¾Ğ³Ğ¾Ğ² Guardian

**Proof:**
```bash
# Loki Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
curl http://localhost:3100/ready
# ready

# Promtail Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ»Ğ¾Ğ³Ğ¸
curl http://localhost:9080/metrics | findstr "promtail_sent_entries_total"
# promtail_sent_entries_total 1234

# Grafana Explore
# Query: {job="guardian"}
# Result: JSON Ğ»Ğ¾Ğ³Ğ¸ Guardian Ñ Ğ¿Ğ¾Ğ»ÑĞ¼Ğ¸ timestamp, level, message
```

**Deliverables:**
- Loki + Promtail Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚
- Ğ›Ğ¾Ğ³Ğ¸ Ğ²ÑĞµÑ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ² Ğ°Ğ³Ñ€ĞµĞ³Ğ¸Ñ€ÑƒÑÑ‚ÑÑ
- Grafana Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ unified logs

---

### Sprint 7: Playwright Smoke Tests
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P1  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2 Ğ´Ğ½Ñ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **Playwright Setup**
   - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ² `apps/admin`:
     ```bash
     pnpm add -D @playwright/test
     pnpm exec playwright install chromium
     ```
   - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `playwright.config.ts`:
     ```ts
     export default defineConfig({
       testDir: './tests/e2e',
       webServer: {
         command: 'pnpm run start',  // Prod build
         port: 3000,
         reuseExistingServer: true
       },
       use: {
         baseURL: 'http://localhost:3000',
         screenshot: 'only-on-failure',
         trace: 'retain-on-failure'
       },
       reporter: [
         ['html', { outputFolder: 'playwright-report' }],
         ['json', { outputFile: 'playwright-results.json' }]
       ]
     })
     ```

2. **Smoke Tests**
   - `tests/e2e/homepage.spec.ts`:
     ```ts
     test('homepage loads without crash', async ({ page }) => {
       await page.goto('/')
       await expect(page.locator('h1')).toContainText('V1')
       await expect(page).toHaveScreenshot('homepage.png')
     })
     ```
   
   - `tests/e2e/diagnostics.spec.ts`:
     ```ts
     test('diagnostics shows system status', async ({ page }) => {
       await page.goto('/diagnostics')
       await expect(page.locator('text=System Status')).toBeVisible()
       await expect(page).toHaveScreenshot('diagnostics.png')
     })
     ```
   
   - `tests/e2e/ignite.spec.ts`:
     ```ts
     test('ignite button exists', async ({ page }) => {
       await page.goto('/')
       const igniteBtn = page.locator('button:has-text("Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹")')
       await expect(igniteBtn).toBeVisible()
     })
     ```

3. **Guardian Integration**
   - `services/guardian/testing/smoke-runner.ts`:
     ```ts
     import { exec } from 'child_process'
     import { promisify } from 'util'
     
     export async function runSmokeTests() {
       const { stdout, stderr } = await promisify(exec)(
         'pnpm exec playwright test',
         { cwd: 'C:/Work/Orchestrator/apps/admin' }
       )
       
       return {
         passed: !stderr.includes('failed'),
         output: stdout,
         timestamp: new Date().toISOString()
       }
     }
     ```
   
   - Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ğ¾ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ: ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 6 Ñ‡Ğ°ÑĞ¾Ğ²
   - ĞŸÑ€Ğ¸ Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ»Ğµ â†’ Ğ±Ğ°Ğ³-Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚ Ñ screenshots

4. **Visual Regression**
   - Baseline screenshots Ğ² `tests/e2e/__screenshots__/`
   - ĞŸÑ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ UI â†’ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ baseline:
     ```bash
     pnpm exec playwright test --update-snapshots
     ```

**Proof:**
```bash
# Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ
cd C:\Work\Orchestrator\apps\admin
pnpm exec playwright test

# Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:
# Running 3 tests using 1 worker
#   âœ“ homepage.spec.ts:3:1 â€º homepage loads without crash (1.2s)
#   âœ“ diagnostics.spec.ts:3:1 â€º diagnostics shows system status (0.8s)
#   âœ“ ignite.spec.ts:3:1 â€º ignite button exists (0.5s)
# 3 passed (2.5s)
```

**Deliverables:**
- Playwright Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½
- 3+ smoke Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚
- Guardian Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ñ‚ĞµÑÑ‚Ñ‹ Ğ¿Ğ¾ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ
- Visual regression snapshots Ğ·Ğ°Ñ„Ğ¸ĞºÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹

---

### Sprint 8: ĞŸĞµÑ€ĞµĞ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² V1
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P2  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 1 Ğ´ĞµĞ½ÑŒ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **Rebrand Ğ² UI**
   - `app/layout.tsx` â†’ title: "V1 â€” AI Orchestrator"
   - Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° â†’ "V1" Ğ²Ğ¼ĞµÑÑ‚Ğ¾ "Orchestrator V6"
   - Favicon (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)

2. **Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ**
   - `README.md` â†’ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ V1
   - `PROJECT-RULES.md` â†’ ÑƒĞ¿Ğ¾Ğ¼Ğ¸Ğ½Ğ°Ğ½Ğ¸Ğµ V1
   - Ğ’ÑĞµ Ğ°Ñ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚Ñ‹ Ğ² `docs/`

3. **Package.json**
   - `name: "v1-orchestrator"`
   - `description: "V1 â€” Stable AI Generation Platform"`

4. **Ğ¡Ğ»ÑƒĞ¶Ğ±Ñ‹ Windows**
   - ĞŸĞµÑ€ĞµĞ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ñ‚ÑŒ:
     - `OrchestratorComfyUI` â†’ `V1ComfyUI`
     - `OrchestratorPanel` â†’ `V1AdminPanel`
     - `OrchestratorGuardian` â†’ `V1Guardian`
   - ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸

**Proof:**
- Ğ‘Ñ€Ğ°ÑƒĞ·ĞµÑ€ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ "V1" Ğ² title
- Ğ¡Ğ»ÑƒĞ¶Ğ±Ñ‹ Ğ¸Ğ¼ĞµÑÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ¸Ğ¼ĞµĞ½Ğ°
- README Ğ°ĞºÑ‚ÑƒĞ°Ğ»ĞµĞ½

**Deliverables:**
- ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ rebrand Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½
- Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ°

---

### Sprint 9: Strict TypeScript + ESLint
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P2  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 1 Ğ´ĞµĞ½ÑŒ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **TypeScript Strict Mode**
   - `tsconfig.json`:
     ```json
     {
       "compilerOptions": {
         "strict": true,
         "noImplicitAny": true,
         "strictNullChecks": true,
         "strictFunctionTypes": true,
         "noUnusedLocals": true,
         "noUnusedParameters": true
       }
     }
     ```
   - Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ğ¸

2. **ESLint Rules**
   - `.eslintrc.json`:
     ```json
     {
       "extends": ["next/core-web-vitals", "plugin:@typescript-eslint/recommended"],
       "rules": {
         "@typescript-eslint/no-explicit-any": "error",
         "@typescript-eslint/no-unused-vars": "error",
         "no-console": "warn"
       }
     }
     ```

3. **Pre-commit Hooks**
   - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `husky` + `lint-staged`
   - `.husky/pre-commit`:
     ```bash
     #!/bin/sh
     pnpm run lint
     pnpm run typecheck
     ```

**Proof:**
```bash
# Build Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ±ĞµĞ· Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
pnpm run build
# âœ“ Compiled successfully

# Lint Ñ‡Ğ¸ÑÑ‚Ñ‹Ğ¹
pnpm run lint
# âœ“ No ESLint warnings or errors
```

**Deliverables:**
- Strict TypeScript Ğ²ĞºĞ»ÑÑ‡Ñ‘Ğ½
- ESLint Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½
- Pre-commit hooks Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚

---

### Sprint 10: Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** P0  
**Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** 2 Ğ´Ğ½Ñ

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸:**
1. **Unified Setup Script**
   - `scripts/setup-v1-complete.ps1`:
     - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ NSSM ÑĞ»ÑƒĞ¶Ğ±Ñ‹
     - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Prometheus/Grafana/Loki
     - Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ windows_exporter
     - ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Sentry
     - Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Playwright baseline
     - ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ `/api/health`

2. **Documentation Hub**
   - `docs/README.md` â€” Ğ¸Ğ½Ğ´ĞµĞºÑ Ğ²ÑĞµĞ¹ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ğ¸
   - `docs/QUICKSTART.md` â€” Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ·Ğ° 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚
   - `docs/ARCHITECTURE.md` â€” Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²
   - `docs/TROUBLESHOOTING.md` â€” Ñ‡Ğ°ÑÑ‚Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹

3. **UI Polish**
   - Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° `/about` â€” Ğ¿Ñ€Ğ¾ V1 Guardian
   - Tooltips Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ¼ (Ğ²ÑĞµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸)
   - Loading states (spinners)
   - Error states (Ğ¿Ğ¾Ğ½ÑÑ‚Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ)

4. **Testing Everything**
   - Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 1: Ğ§Ğ¸ÑÑ‚Ğ°Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Windows â†’ `setup-v1-complete.ps1` â†’ Ğ²ÑÑ‘ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
   - Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 2: Ğ£Ğ±Ğ¸Ñ‚ÑŒ ComfyUI â†’ Guardian Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ·Ğ° 30 ÑĞµĞº
   - Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 3: Ğ¡Ğ¼Ğ¾ÑƒĞº-Ñ‚ĞµÑÑ‚Ñ‹ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´ÑÑ‚
   - Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 4: Grafana Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
   - Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 5: Sentry Ğ»Ğ¾Ğ²Ğ¸Ñ‚ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸

5. **Final Report**
   - `docs/V1-GUARDIAN-FINAL-REPORT.md`:
     - Ğ’ÑĞµ 10 ÑĞ¿Ñ€Ğ¸Ğ½Ñ‚Ğ¾Ğ² Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ñ‹
     - Proof Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°
     - ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ (uptime, recovery time, test pass rate)
     - Known Issues
     - Roadmap V2

**Proof:**
- Setup script Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ğ²ÑÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¾Ğ¹
- Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ°Ñ Ğ¸ Ğ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ
- UI Ğ±ĞµĞ· Ğ±Ğ°Ğ³Ğ¾Ğ²
- Ğ’ÑĞµ Ñ‚ĞµÑÑ‚Ñ‹ Ğ·ĞµĞ»Ñ‘Ğ½Ñ‹Ğµ

**Deliverables:**
- V1 Guardian Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹
- Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ release-ready
- ĞŸÑ€ĞµĞ·ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ stakeholders Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ°

---

## ğŸ› ï¸ Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº

### Runtime & Framework
| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ | Ğ’ĞµÑ€ÑĞ¸Ñ |
|-----------|------------|--------|
| Backend | Next.js App Router | 15.0.3 |
| Frontend | React | 18.3.1 |
| Runtime | Node.js | 22.20.0 |
| Package Manager | pnpm | 8+ |

### ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ & Observability
| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ | Ğ¦ĞµĞ»ÑŒ |
|-----------|------------|------|
| Errors | Sentry | Ğ—Ğ°Ñ…Ğ²Ğ°Ñ‚ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹ Ñ„Ñ€Ğ¾Ğ½Ñ‚+Ğ±ÑĞº |
| Metrics | Prometheus + prom-client | ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ |
| System Metrics | windows_exporter | CPU/RAM/Disk/Network |
| Logs | Grafana Loki + Promtail | Unified log aggregation |
| Dashboards | Grafana | Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº/Ğ»Ğ¾Ğ³Ğ¾Ğ² |
| Traces (Ğ¾Ğ¿Ñ†.) | OpenTelemetry | Distributed tracing |

### Testing
| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ | Ğ¦ĞµĞ»ÑŒ |
|-----------|------------|------|
| E2E Tests | Playwright | Smoke tests + visual regression |
| Unit Tests (Ğ¾Ğ¿Ñ†.) | Vitest | Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° |

### Infrastructure
| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ | Ğ¦ĞµĞ»ÑŒ |
|-----------|------------|------|
| Service Management | NSSM | Windows ÑĞ»ÑƒĞ¶Ğ±Ñ‹ Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ·Ğ°Ğ¿ÑƒÑĞºĞ¾Ğ¼ |
| Database | Better-SQLite3 | Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ‘Ğ” (jobs, messages) |
| Logging | Pino | Structured JSON logs |

---

## ğŸ”— Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¾Ğ¹

### Ğ§Ñ‚Ğ¾ ÑƒĞ¶Ğµ ĞµÑÑ‚ÑŒ (ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚ 9b2f1c8)
âœ… **Sprint 1 Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½:**
- `lib/service-control.ts` â€” ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ»ÑƒĞ¶Ğ±Ğ°Ğ¼Ğ¸ Ñ‡ĞµÑ€ĞµĞ· sc.exe
- `/api/system/comfy/start|stop|status` â€” REST API Ğ´Ğ»Ñ ÑĞ»ÑƒĞ¶Ğ±
- `/api/system/ignite` â€” Ğ¼Ğ°ÑÑĞ¾Ğ²Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº
- `/api/status` â€” health check (Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹)
- `app/error.tsx` + `app/global-error.tsx` â€” error boundaries
- FLUX dry-run mode (`ALLOW_GENERATION` flag)
- `scripts/install-comfy-service.ps1` â€” NSSM setup ComfyUI

### Ğ§Ñ‚Ğ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ

#### 1. Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… endpoints
**Ğ¤Ğ°Ğ¹Ğ»:** `/api/status/route.ts` â†’ `/api/health/route.ts`
- ĞŸĞµÑ€ĞµĞ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ»Ñ Kubernetes-ÑÑ‚Ğ¸Ğ»Ñ
- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ: `diskF`, `memory`, `uptime`
- Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°:
  ```json
  {
    "status": "healthy|degraded|unhealthy",
    "timestamp": "ISO8601",
    "services": {...},
    "comfy": {...},
    "system": {
      "diskF": {"free": "250GB", "total": "500GB"},
      "memory": {"used": "16GB", "total": "32GB"},
      "uptime": "3d 5h 12m"
    }
  }
  ```

#### 2. ĞĞ¾Ğ²Ñ‹Ğµ endpoints Ğ´Ğ»Ñ Guardian
- `/api/guardian/control` â€” POST start/stop Guardian
- `/api/guardian/status` â€” GET ÑÑ‚Ğ°Ñ‚ÑƒÑ Guardian
- `/api/guardian/run-smoke` â€” POST Ğ·Ğ°Ğ¿ÑƒÑĞº ÑĞ¼Ğ¾ÑƒĞº-Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ
- `/api/metrics` â€” GET Prometheus metrics

#### 3. Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ UI
**Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°:** `/diagnostics` (ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚)

**Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞµĞºÑ†Ğ¸Ğ¸:**
- **System Health** â€” Ğ·ĞµĞ»Ñ‘Ğ½Ñ‹Ğµ/ĞºÑ€Ğ°ÑĞ½Ñ‹Ğµ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹ (ÑƒĞ¶Ğµ ĞµÑÑ‚ÑŒ)
- **Grafana** â€” ĞºĞ½Ğ¾Ğ¿ĞºĞ° "ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ñ‹" â†’ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾
- **Sentry** â€” "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸" â†’ Ğ²ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ²Ğ¸Ğ´Ğ¶ĞµÑ‚
- **Logs** â€” "ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Loki" â†’ Grafana Explore
- **Guardian** â€” ÑÑ‚Ğ°Ñ‚ÑƒÑ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ¶Ğ° + ĞºĞ½Ğ¾Ğ¿ĞºĞ° "Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞ¼Ğ¾ÑƒĞº-Ñ‚ĞµÑÑ‚Ñ‹"

#### 4. ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ NSSM ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ²
**Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ:**
- `scripts/install-panel-service.ps1` â€” AdminPanel ĞºĞ°Ğº ÑĞ»ÑƒĞ¶Ğ±Ğ°
- `scripts/install-guardian-service.ps1` â€” V1 Guardian ĞºĞ°Ğº ÑĞ»ÑƒĞ¶Ğ±Ğ°
- `scripts/uninstall-all-services.ps1` â€” Ğ´ĞµĞ¸Ğ½ÑÑ‚Ğ°Ğ»Ğ»ÑÑ†Ğ¸Ñ

**ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ:**
- `scripts/install-comfy-service.ps1` â†’ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ restart policy

---

## ğŸ“Š ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ÑƒÑĞ¿ĞµÑ…Ğ°

### ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ (Definition of Done)

| ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ° | Ğ¦ĞµĞ»ÑŒ | Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ | ĞŸĞ¾ÑĞ»Ğµ V1 |
|---------|------|---------|----------|
| Uptime (7 Ğ´Ğ½ĞµĞ¹) | >99% | ~85% (Ñ€ÑƒÑ‡Ğ½Ñ‹Ğµ Ñ€ĞµÑÑ‚Ğ°Ñ€Ñ‚Ñ‹) | >99% (auto-recovery) |
| Recovery Time | <60 ÑĞµĞº | ~5 Ğ¼Ğ¸Ğ½ (Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ¹) | <30 ÑĞµĞº (auto) |
| White Screen Events | 0 | 2-3/Ğ½ĞµĞ´ĞµĞ»Ñ | 0 (visual regression) |
| Bug Reports Generated | ĞĞ²Ñ‚Ğ¾ | Ğ’Ñ€ÑƒÑ‡Ğ½ÑƒÑ | ĞĞ²Ñ‚Ğ¾ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¸Ğ½Ñ†Ğ¸Ğ´ĞµĞ½Ñ‚ |
| Smoke Tests Pass Rate | >95% | ĞĞµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ÑÑ‚ÑÑ | >98% |
| Build Success Rate | 100% | 100% | 100% |
| Sentry Error Rate | <10/Ğ´ĞµĞ½ÑŒ | N/A | <5/Ğ´ĞµĞ½ÑŒ |
| Prometheus Targets UP | 100% | N/A | 100% |

### KPIs (Key Performance Indicators)

**Availability:**
- 99.5% uptime Ğ·Ğ° Ğ¼ĞµÑÑÑ†
- MTTR (Mean Time To Recovery) < 1 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°
- MTTD (Mean Time To Detect) < 30 ÑĞµĞºÑƒĞ½Ğ´

**Quality:**
- 0 Ğ±ĞµĞ»Ñ‹Ñ… ÑĞºÑ€Ğ°Ğ½Ğ¾Ğ² Ğ² production
- <5 critical errors Ğ² Sentry Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ
- 100% smoke tests passed

**Efficiency:**
- Setup time Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹ < 30 Ğ¼Ğ¸Ğ½ÑƒÑ‚
- Time to first bug report < 2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¸Ğ½Ñ†Ğ¸Ğ´ĞµĞ½Ñ‚Ğ°
- Developer onboarding < 1 Ñ‡Ğ°Ñ

---

## ğŸš€ ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

### Prerequisites
- Windows 10/11 Pro (Ğ´Ğ»Ñ NSSM ÑĞ»ÑƒĞ¶Ğ±)
- Node.js 22.20+
- pnpm 8+
- PowerShell 7+ (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
- Git
- ComfyUI ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ğ² `F:\ComfyUI`

### Quick Start (Ğ¿Ğ¾ÑĞ»Ğµ Sprint 10)
```powershell
# 1. ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹
git clone https://github.com/offflinerpsy/orchestrator-v3.git
cd orchestrator-v3

# 2. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
pnpm install

# 3. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ .env.local
cp apps/admin/.env.example apps/admin/.env.local
# Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ: BFL_API_KEY, V0_API_KEY, SENTRY_DSN

# 4. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ½ÑƒÑ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºÑƒ (Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ Admin)
.\scripts\setup-v1-complete.ps1

# 5. ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ
start http://localhost:3000

# 6. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Grafana
start http://localhost:3003
```

---

## ğŸ“ ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¸ FAQ

### Ğ§Ğ°ÑÑ‚Ñ‹Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹

**Q: ĞšĞ°Ğº Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Guardian?**
```powershell
nssm restart V1Guardian
```

**Q: Ğ“Ğ´Ğµ Ğ»Ğ¾Ğ³Ğ¸ Guardian?**
```
F:\Logs\guardian\guardian.log
```

**Q: ĞšĞ°Ğº Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Playwright snapshots?**
```bash
cd apps/admin
pnpm exec playwright test --update-snapshots
```

**Q: Sentry Ğ½Ğµ Ğ»Ğ¾Ğ²Ğ¸Ñ‚ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸?**
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ `SENTRY_DSN` Ğ² `.env.local`
- Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ `@sentry/nextjs` ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ `sentry.*.config.ts` Ñ„Ğ°Ğ¹Ğ»Ñ‹

**Q: Prometheus Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ /api/metrics?**
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ `prometheus.yml` scrape config
- Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ AdminPanel Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½
- Ğ¢ĞµÑÑ‚: `curl http://localhost:3000/api/metrics`

---

## ğŸ—ºï¸ Roadmap V2 (Ğ¿Ğ¾ÑĞ»Ğµ V1)

### ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ
1. **Docker Support** â€” ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ²ÑĞµÑ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
2. **Multi-machine Setup** â€” Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°
3. **Advanced Alerting** â€” Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Telegram/Discord
4. **ML-based Anomaly Detection** â€” Ğ¿Ñ€ĞµĞ´ÑĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¹
5. **Auto-scaling ComfyUI** â€” Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¾Ğ¹
6. **Cloud Backup** â€” Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ±ÑĞºĞ°Ğ¿Ñ‹ Ğ² S3/OneDrive
7. **Web UI Ğ´Ğ»Ñ Guardian** â€” dashboard Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ»Ğ¾Ğ³Ğ¾Ğ²
8. **API Rate Limiting** â€” Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ DDOS
9. **OAuth Authentication** â€” secure login
10. **Mobile App** â€” Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ñ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ°

---

## ğŸ“ Changelog

### v1.0.0 (ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ)
- âœ… Sprint 0: Master Plan ÑĞ¾Ğ·Ğ´Ğ°Ğ½
- â³ Sprint 1: Guardian Service + Health Check
- â³ Sprint 2: Auto-Recovery
- â³ Sprint 3-10: ...

---

**ĞĞ²Ñ‚Ğ¾Ñ€:** Ğ Ğ•Ğ’Ğ˜Ğ—ĞĞ ++ Agent  
**Ğ”Ğ°Ñ‚Ğ°:** 2025-10-19  
**Ğ’ĞµÑ€ÑĞ¸Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°:** 1.0  
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** Draft â†’ Review Required
